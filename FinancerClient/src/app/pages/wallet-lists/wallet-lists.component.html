<div class="wallet-lists-container" *ngIf="!loading">
  <div class="header">
    <h2 class="title">Archived Wallets</h2>
    <p class="subtitle">Review your past financial periods</p>
  </div>

  <!-- Error -->
  <div *ngIf="error" class="error-message">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="8" x2="12" y2="12"></line>
      <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </svg>
    <span>{{ error }}</span>
  </div>

  <!-- Empty -->
  <div *ngIf="wallets.length === 0 && !error" class="empty-state">
    <div class="empty-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
        <line x1="12" y1="2" x2="12" y2="6"></line>
        <line x1="12" y1="18" x2="12" y2="22"></line>
        <line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line>
        <line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line>
        <line x1="2" y1="12" x2="6" y2="12"></line>
        <line x1="18" y1="12" x2="22" y2="12"></line>
        <line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line>
        <line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line>
      </svg>
    </div>
    <h3>No archived wallets yet</h3>
    <p>Wallets will appear here once they're archived</p>
  </div>

  <!-- Wallet cards -->
  <div class="wallet-grid" *ngIf="wallets.length > 0">
    <div
      class="wallet-card"
      *ngFor="let wallet of wallets"
      (click)="goToWallet(wallet)"
    >
      <div class="card-header">
        <div class="month-badge">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          <span>{{ wallet.monthFormatted }}</span>
        </div>
        
        <button
          class="icon-btn danger"
          (click)="$event.stopPropagation(); confirmDeleteWallet(wallet.id)"
          aria-label="Delete wallet"
        >
          <lucide-icon [img]="Trash2"></lucide-icon>
        </button>
      </div>
      
      <div class="wallet-info">
        <div class="info-row">
          <span class="label">Income:</span>
          <span class="value income">₱{{ wallet.income | number:'1.0-0' }}</span>
        </div>
        
        <div class="info-row">
          <span class="label">Expenses:</span>
          <span class="value expenses">₱{{ wallet.totalExpenses | number:'1.0-0' }}</span>
        </div>
        
        <div class="info-row">
          <span class="label">Balance:</span>
          <span class="value balance" [class.positive]="wallet.balance >= 0" [class.negative]="wallet.balance < 0">
            ₱{{ wallet.balance | number:'1.0-0' }}
          </span>
        </div>
      </div>
      
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="getExpensePercentage(wallet)"></div>
      </div>
      
      <div class="card-footer">
        <span class="hint">Click to view details</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </div>
    </div>
  </div>
</div>

<!-- Delete Confirmation -->
<app-confirmation-modal
  [visible]="showConfirmDelete"
  title="Delete Wallet"
  message="Are you sure you want to permanently delete this wallet? This action cannot be undone."
  confirmText="Delete"
  cancelText="Cancel"
  (confirm)="deleteWalletConfirmed()"
  (cancel)="showConfirmDelete = false">
</app-confirmation-modal>

<app-open-wallet
  *ngIf="selectedWallet"
  [wallet]="selectedWallet"
  [visible]="showOpenWallet"
  [onClose]="closeOpenWallet">
</app-open-wallet>